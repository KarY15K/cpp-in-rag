# 38.如何防止一个头文件 include  多次

# 38.如何防止一个头文件 include  多次


前言：一般来说，程序员会遵守只包含一次头文件的规则，但会有一种情况程序员可能在不知情的情况下多次包含同一个头文件，即可能使用了包含另一个头文件的头文件。  
例如：如下三个文件



```plain
// 头文件h1.h
...//文件内容
```



```plain
//头文件h2.h
#include"h1.h"//包含头文件h1.h
...//文件内容
```



```plain
//源文件c.cpp
#include"h1.h"
#include"h2.h"//这时由于头文件h2.h中已经包含过头文件h1.h,因此头文件h1.h被重复包含
...//文件内容
```



**解决方法：使用预处理编译指令#ifndef（if not define）**



```plain
//头文件h1.h
#ifndf H1
#define H1
...//文件内容
#endif
```



**解释：**  
在所有头文件中加上如上的三行代码，编译器在首次遇到该文件时，H1还没有被定义，则将继续执行#ifndef和#endif之间的内容，并且其中#define H1语句定义了H1。如果在源文件中重复包含这个一个头文件时，编译器会第二次遇到该文件，由于第一次遇到时#define H1语句定义了H1，于是在第二次遇到该文件并执行#ifndef H1时会发现已经定义过H1，于是跳过#ifndef和#endif之间的内容，避免重复执行执行头文件中内容（比如结构声明，函数声明，函数定义等）。



注：#ifndf 后的名称是自己选择的，尽量选择一个在其他地方一般不太可能被定义的名称，以免重复定义。



> 更新: 2024-04-19 15:30:42  
> 原文: <https://www.yuque.com/linuxer/gscfv1/229685981476fa2adc8d5b0de0ea0003>