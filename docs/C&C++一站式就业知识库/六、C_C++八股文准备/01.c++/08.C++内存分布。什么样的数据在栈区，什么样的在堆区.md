# 08.C++内存分布。什么样的数据在栈区，什么样的在堆区

# 08.C++内存分布。什么样的数据在栈区，什么样的在堆区


## 1.栈区(satck)


由编译器自动分配释放, 存放函数的参数值,局部变量等。主要存放函数的参数以及局部变量。在函数完成执行，系统自行释放栈区内存，不需要用户管理。整个程序的栈区的大小可以在编译器中由用户自行设定，VS中默认的栈区大小为1M，可通过VS手动更改栈的大小。64bits的Linux默认栈大小为10MB，可通过ulimit -s临时修改。  
例如: 参数buf,参数bufsize和size都是存放在栈区.当函数执行完毕的时候,自动释放



```plain
void  recev(char* buf, int bufsize){
	int size;
}
```



## 2.堆区


一般由程序员分配释放(动态内存申请与释放)，若程序员不释放，程序结束时可能由操作系统回收。，堆的总大小为机器的虚拟内存大小。  
说明：c<u>中new操作符本质上是使用了malloc进行内存的申请，new和malloc的区别如下：  
</u><u>（1）malloc是C语言中的函数，而new是C</u>中的操作符。  
（2）malloc申请之后返回的类型是void*，而new返回的指针带有类型。  
（3）malloc只负责内存的分配而不会调用类的构造函数，而new不仅会分配内存，而且会自动调用类的构造函数。  
（4）由new分配的内存块放在堆区，用delete结束生命，由malloc等分配的内存块放在自由存储区，和堆类似，用free来结束生命。  
例如:下面的src所指向的内存空间就是在堆区



```plain
char* src = (char*) malloc(sizeof(buf) * sizeof(10));
```



> 更新: 2024-04-19 15:30:01  
> 原文: <https://www.yuque.com/linuxer/gscfv1/0c67edbdbb300a676b7c366e7c38ee5b>